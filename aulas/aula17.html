<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula 17 - Relacionamentos e EF Core Avan√ßado | Desenvolvimento Web - UNINOVE</title>
    <link rel="stylesheet" href="css/slides.css">
</head>
<body>
    <div class="presentation">

        <!-- SLIDE 1: Capa -->
        <div class="slide slide-cover active">
            <h1>Desenvolvimento Web</h1>
            <h2>Aula 17 ‚Äî Relacionamentos e EF Core Avan√ßado</h2>
            <p>Chaves estrangeiras, LINQ e Include</p>
            <p style="margin-top: 30px; font-size: 0.9em; color: rgba(255,255,255,0.5);">2026.1 ‚Äî 120 minutos</p>
        </div>

        <!-- SLIDE 2: Recapitula√ß√£o -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Recapitula√ß√£o ‚Äî Aula 16</h2></div>
            <div class="slide-body">
                <div class="recap-container">
                    <h3>O que vimos na aula passada</h3>
                    <ul class="recap-items">
                        <li class="recap-item"><strong>API REST:</strong> Interface para comunica√ß√£o entre sistemas via HTTP</li>
                        <li class="recap-item"><strong>Verbos HTTP:</strong> GET (ler), POST (criar), PUT (atualizar), DELETE (excluir)</li>
                        <li class="recap-item"><strong>[ApiController]:</strong> Herda de ControllerBase e retorna JSON</li>
                        <li class="recap-item"><strong>Swagger:</strong> Documenta√ß√£o interativa para testar a API</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- SLIDE 3: Mini Quiz (in√≠cio ‚Äî refor√ßo) -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Mini Quiz ‚Äî Revis√£o</h2></div>
            <div class="slide-body" style="justify-content: center;">
                <div class="quiz-container" data-answer="c">
                    <h3>Vamos relembrar!</h3>
                    <p class="quiz-question">Qual status code HTTP indica que um recurso foi <strong>criado com sucesso</strong>?</p>
                    <ul class="quiz-options">
                        <li><button class="quiz-option" data-option="a">a) 200 OK</button></li>
                        <li><button class="quiz-option" data-option="b">b) 204 No Content</button></li>
                        <li><button class="quiz-option" data-option="c">c) 201 Created</button></li>
                        <li><button class="quiz-option" data-option="d">d) 404 Not Found</button></li>
                    </ul>
                    <div class="quiz-feedback">A resposta correta √© <strong>(c)</strong>. O status <strong>201 Created</strong> indica que o recurso foi criado com sucesso. No ASP.NET, usamos <span class="inline-code">CreatedAtAction()</span>.</div>
                </div>
            </div>
        </div>

        <!-- SLIDE 4: Agenda -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Agenda</h2></div>
            <div class="slide-body">
                <ul class="agenda-list">
                    <li>Relacionamentos em Banco de Dados</li>
                    <li>Relacionamento 1:N no EF Core</li>
                    <li>Navigation Properties</li>
                    <li>Include() ‚Äî Carregamento Eager</li>
                    <li>LINQ ‚Äî Consultas Avan√ßadas</li>
                    <li>Caso de Uso Real: Mercado Livre</li>
                    <li>Exerc√≠cio Guiado: Categorias e Produtos</li>
                </ul>
            </div>
        </div>

        <!-- SLIDE 5: Relacionamentos -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Relacionamentos em Banco de Dados</h2></div>
            <div class="slide-body">
                <div class="concept-cards" style="margin-top: 10px;">
                    <div class="concept-card">
                        <span class="card-icon">1Ô∏è‚É£</span>
                        <h4>1:1 (Um para Um)</h4>
                        <p>Usu√°rio tem 1 Perfil</p>
                    </div>
                    <div class="concept-card" style="border-left: 4px solid #E8505B;">
                        <span class="card-icon">üì¶</span>
                        <h4>1:N (Um para Muitos)</h4>
                        <p>Categoria tem N Produtos</p>
                    </div>
                    <div class="concept-card">
                        <span class="card-icon">üîó</span>
                        <h4>N:N (Muitos para Muitos)</h4>
                        <p>Aluno cursa N Disciplinas</p>
                    </div>
                </div>
                <div class="diagram-flow" style="margin-top: 15px; justify-content: center;">
                    <div class="diagram-box highlight" style="min-width: 130px;">
                        <span class="box-label">Categoria</span>
                        <span class="box-desc">Id, Nome</span>
                    </div>
                    <span class="diagram-arrow">1 ‚Üí N</span>
                    <div class="diagram-box highlight-coral" style="min-width: 130px;">
                        <span class="box-label">Produto</span>
                        <span class="box-desc">Id, Nome, CategoriaId</span>
                    </div>
                </div>
                <p style="text-align: center; font-size: 0.85em; color: #888; margin-top: 5px;">A chave estrangeira <span class="inline-code">CategoriaId</span> fica na tabela Produto</p>
            </div>
        </div>

        <!-- SLIDE 6: Models com relacionamento -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Relacionamento 1:N no EF Core</h2></div>
            <div class="slide-body">
                <pre>
<span class="comment">// Models/Categoria.cs</span>
<span class="keyword">public class</span> <span class="type">Categoria</span>
{
    <span class="keyword">public int</span> Id { <span class="keyword">get</span>; <span class="keyword">set</span>; }

    [<span class="type">Required</span>]
    <span class="keyword">public string</span> Nome { <span class="keyword">get</span>; <span class="keyword">set</span>; } = <span class="js-string">""</span>;

    <span class="comment">// Navigation Property ‚Äî lista de produtos</span>
    <span class="keyword">public</span> List&lt;<span class="type">Produto</span>&gt; Produtos { <span class="keyword">get</span>; <span class="keyword">set</span>; } = <span class="keyword">new</span>();
}

<span class="comment">// Models/Produto.cs (atualizado)</span>
<span class="keyword">public class</span> <span class="type">Produto</span>
{
    <span class="keyword">public int</span> Id { <span class="keyword">get</span>; <span class="keyword">set</span>; }
    <span class="keyword">public string</span> Nome { <span class="keyword">get</span>; <span class="keyword">set</span>; } = <span class="js-string">""</span>;
    <span class="keyword">public decimal</span> Preco { <span class="keyword">get</span>; <span class="keyword">set</span>; }

    <span class="comment">// Chave estrangeira</span>
    <span class="keyword">public int</span> CategoriaId { <span class="keyword">get</span>; <span class="keyword">set</span>; }

    <span class="comment">// Navigation Property</span>
    <span class="keyword">public</span> <span class="type">Categoria</span>? Categoria { <span class="keyword">get</span>; <span class="keyword">set</span>; }
}</pre>
            </div>
        </div>

        <!-- SLIDE 7: Include -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Include() ‚Äî Carregamento Eager</h2></div>
            <div class="slide-body">
                <p>Por padr√£o, o EF Core <strong>n√£o carrega</strong> os dados relacionados. Use <span class="inline-code">Include()</span> para trazer os dados junto:</p>
                <pre>
<span class="comment">// SEM Include ‚Äî Categoria ser√° null!</span>
<span class="keyword">var</span> <span class="js-var">produtos</span> = _context.Produtos.<span class="js-func">ToList</span>();
<span class="comment">// produto.Categoria == null ‚ùå</span>

<span class="comment">// COM Include ‚Äî Categoria √© carregada!</span>
<span class="keyword">var</span> <span class="js-var">produtos</span> = _context.Produtos
    .<span class="js-func">Include</span>(p => p.Categoria)
    .<span class="js-func">ToList</span>();
<span class="comment">// produto.Categoria.Nome == "Eletr√¥nicos" ‚úÖ</span></pre>
                <div class="analogy-box" style="margin-top: 10px;">
                    <span class="analogy-icon">üì¶</span>
                    <div class="analogy-text">
                        <h4>Analogia: Encomenda</h4>
                        <p>Sem Include, voc√™ recebe a caixa vazia (s√≥ o ID da categoria). Com Include, a caixa vem com o conte√∫do completo (nome, descri√ß√£o, etc.).</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 8: LINQ -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>LINQ ‚Äî Consultas Avan√ßadas</h2></div>
            <div class="slide-body">
                <p><strong>LINQ</strong> (Language Integrated Query) permite fazer consultas no banco usando C#:</p>
                <pre>
<span class="comment">// Filtrar por categoria</span>
<span class="keyword">var</span> <span class="js-var">eletronicos</span> = _context.Produtos
    .<span class="js-func">Where</span>(p => p.Categoria.Nome == <span class="js-string">"Eletr√¥nicos"</span>)
    .<span class="js-func">ToList</span>();

<span class="comment">// Ordenar por pre√ßo (menor ‚Üí maior)</span>
<span class="keyword">var</span> <span class="js-var">ordenados</span> = _context.Produtos
    .<span class="js-func">OrderBy</span>(p => p.Preco).<span class="js-func">ToList</span>();

<span class="comment">// Top 5 mais caros</span>
<span class="keyword">var</span> <span class="js-var">top5</span> = _context.Produtos
    .<span class="js-func">OrderByDescending</span>(p => p.Preco)
    .<span class="js-func">Take</span>(<span class="number">5</span>).<span class="js-func">ToList</span>();

<span class="comment">// Contar produtos por categoria</span>
<span class="keyword">var</span> <span class="js-var">contagem</span> = _context.Categorias
    .<span class="js-func">Select</span>(c => <span class="keyword">new</span> { c.Nome, Total = c.Produtos.<span class="js-func">Count</span>() })
    .<span class="js-func">ToList</span>();</pre>
            </div>
        </div>

        <!-- SLIDE 9: Dropdown -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Dropdown de Categorias na View</h2></div>
            <div class="slide-body">
                <pre>
<span class="comment">// Controller ‚Äî Enviar categorias para a View</span>
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">Create</span>()
{
    ViewBag.Categorias = <span class="keyword">new</span> SelectList(
        _context.Categorias, <span class="js-string">"Id"</span>, <span class="js-string">"Nome"</span>);
    <span class="keyword">return</span> <span class="js-func">View</span>();
}

<span class="comment">&lt;!-- View ‚Äî Dropdown de categorias --&gt;</span>
&lt;<span class="html-name">div</span> <span class="html-attr">class</span>=<span class="html-value">"form-group"</span>&gt;
    &lt;<span class="html-name">label</span> <span class="html-attr">asp-for</span>=<span class="html-value">"CategoriaId"</span>&gt;Categoria&lt;/<span class="html-name">label</span>&gt;
    &lt;<span class="html-name">select</span> <span class="html-attr">asp-for</span>=<span class="html-value">"CategoriaId"</span>
            <span class="html-attr">asp-items</span>=<span class="html-value">"ViewBag.Categorias"</span>
            <span class="html-attr">class</span>=<span class="html-value">"form-control"</span>&gt;
        &lt;<span class="html-name">option</span> <span class="html-attr">value</span>=<span class="html-value">""</span>&gt;Selecione...&lt;/<span class="html-name">option</span>&gt;
    &lt;/<span class="html-name">select</span>&gt;
&lt;/<span class="html-name">div</span>&gt;</pre>
            </div>
        </div>

        <!-- SLIDE 10: Caso de Uso Real -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Caso de Uso Real</h2></div>
            <div class="slide-body">
                <div class="real-world">
                    <h3>Mercado Livre ‚Äî Categorias e Produtos</h3>
                    <span class="company-tag">Mercado Livre</span>
                    <span class="company-tag">Relacionamentos</span>
                    <span class="company-tag">1:N</span>
                    <p style="margin-top: 10px;">No Mercado Livre, cada <strong>produto</strong> pertence a uma <strong>categoria</strong> (Eletr√¥nicos, Roupas, etc.), cada <strong>vendedor</strong> tem v√°rios <strong>produtos</strong>, e cada <strong>compra</strong> tem v√°rios <strong>itens</strong>. Todos esses s√£o relacionamentos 1:N implementados com chaves estrangeiras.</p>
                </div>
                <div class="concept-cards" style="margin-top: 10px;">
                    <div class="concept-card">
                        <span class="card-icon">üè™</span>
                        <h4>Vendedor ‚Üí Produtos</h4>
                        <p>1 vendedor tem N produtos</p>
                    </div>
                    <div class="concept-card">
                        <span class="card-icon">üìÇ</span>
                        <h4>Categoria ‚Üí Produtos</h4>
                        <p>1 categoria tem N produtos</p>
                    </div>
                    <div class="concept-card">
                        <span class="card-icon">üõí</span>
                        <h4>Compra ‚Üí Itens</h4>
                        <p>1 compra tem N itens</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 11: Exerc√≠cio Guiado -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Exerc√≠cio Guiado</h2></div>
            <div class="slide-body">
                <div class="guided-exercise">
                    <h3>Categorias e Produtos com Relacionamento</h3>
                    <div class="timebox">40 minutos</div>
                    <ol class="guided-steps">
                        <li>Crie o Model <span class="inline-code">Categoria</span> com Id e Nome</li>
                        <li>Adicione <span class="inline-code">CategoriaId</span> e a Navigation Property no Model <span class="inline-code">Produto</span></li>
                        <li>Adicione <span class="inline-code">DbSet&lt;Categoria&gt;</span> no DbContext</li>
                        <li>Crie e aplique a migration</li>
                        <li>Crie um CRUD simples para Categorias</li>
                        <li>No formul√°rio de Produto, adicione um dropdown de Categorias</li>
                        <li>Na listagem de Produtos, use <span class="inline-code">Include()</span> para exibir o nome da Categoria</li>
                        <li>Teste: crie 3 categorias, cadastre produtos em cada uma e verifique a listagem</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- SLIDE 12: Prepara√ß√£o -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Prepara√ß√£o para a Pr√≥xima Aula</h2></div>
            <div class="slide-body" style="justify-content: center;">
                <div class="box-preclass">
                    <h3>Atividade Pr√©-Aula (Obrigat√≥ria)</h3>
                    <p>Para a <strong>Aula 18 ‚Äî Layout, Partial Views e Bootstrap</strong>:</p>
                    <ol style="margin-top: 10px;">
                        <li>Pesquise o que √© o <span class="inline-code">_Layout.cshtml</span> no ASP.NET Core MVC</li>
                        <li>Leia sobre <strong>Partial Views</strong> e quando us√°-las</li>
                        <li>Acesse o site do <strong>Bootstrap</strong> e explore os componentes (navbar, cards, buttons)</li>
                        <li>Pense: como o Facebook mant√©m o menu de navega√ß√£o igual em todas as p√°ginas?</li>
                    </ol>
                    <p style="margin-top: 15px;"><strong>Tempo estimado:</strong> 25 minutos</p>
                </div>
            </div>
        </div>

        <!-- SLIDE 13: Encerramento -->
        <div class="slide slide-cover">
            <h1>Obrigado!</h1>
            <h2>D√∫vidas?</h2>
            <p>jose.romualdo@uni9.pro.br</p>
            <p style="margin-top: 30px; font-size: 0.9em; color: rgba(255,255,255,0.5);">Aula 17 ‚Äî Relacionamentos e EF Core Avan√ßado</p>
        </div>

    </div>
    <script src="js/slides.js"></script>
</body>
</html>
