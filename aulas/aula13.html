<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula 13 - Cookies e Sess√µes | Desenvolvimento Web - UNINOVE</title>
    <link rel="stylesheet" href="css/slides.css">
</head>
<body>
    <div class="presentation">

        <!-- SLIDE 1: Capa -->
        <div class="slide slide-cover active">
            <h1>Desenvolvimento Web</h1>
            <h2>Aula 13 ‚Äî Cookies e Sess√µes</h2>
            <p>Gerenciamento de estado em aplica√ß√µes web</p>
            <p style="margin-top: 30px; font-size: 0.9em; color: rgba(255,255,255,0.5);">2026.1 ‚Äî 120 minutos</p>
        </div>

        <!-- SLIDE 2: Recapitula√ß√£o -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Recapitula√ß√£o ‚Äî Aula 12</h2></div>
            <div class="slide-body">
                <div class="recap-container">
                    <h3>O que vimos na aula passada</h3>
                    <ul class="recap-items">
                        <li class="recap-item"><strong>CRUD:</strong> Create, Read, Update e Delete ‚Äî as 4 opera√ß√µes b√°sicas</li>
                        <li class="recap-item"><strong>Add() + SaveChanges():</strong> Insere um registro no banco</li>
                        <li class="recap-item"><strong>Find() / ToList():</strong> Busca registros por ID ou lista todos</li>
                        <li class="recap-item"><strong>Update() / Remove():</strong> Atualiza ou exclui registros</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- SLIDE 3: Agenda -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Agenda</h2></div>
            <div class="slide-body">
                <ul class="agenda-list">
                    <li>O problema: HTTP √© stateless</li>
                    <li>Cookies ‚Äî O que s√£o e como funcionam</li>
                    <li>Cookies no ASP.NET Core</li>
                    <li>Mini Quiz</li>
                    <li>Sess√µes ‚Äî O que s√£o e como funcionam</li>
                    <li>Sess√µes no ASP.NET Core</li>
                    <li>Caso de Uso Real: Amazon</li>
                    <li>Exerc√≠cio Guiado: Carrinho de Compras</li>
                </ul>
            </div>
        </div>

        <!-- SLIDE 4: HTTP √© stateless -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>O Problema: HTTP √© Stateless</h2></div>
            <div class="slide-body">
                <p>O protocolo HTTP <strong>n√£o guarda informa√ß√µes</strong> entre requisi√ß√µes. Cada requisi√ß√£o √© independente.</p>
                <div class="analogy-box" style="margin-top: 15px;">
                    <span class="analogy-icon">ü§î</span>
                    <div class="analogy-text">
                        <h4>Analogia: Gar√ßom sem mem√≥ria</h4>
                        <p>Imagine um gar√ßom que esquece tudo a cada vez que vai √† cozinha. Voc√™ pede uma pizza, ele vai buscar, volta e pergunta: "O que voc√™ pediu?" ‚Äî Esse √© o HTTP sem cookies/sess√µes!</p>
                    </div>
                </div>
                <div class="diagram-flow" style="margin-top: 15px; justify-content: center;">
                    <div class="diagram-box" style="min-width: 130px;">
                        <span class="box-label">Requisi√ß√£o 1</span>
                        <span class="box-desc">Login do usu√°rio</span>
                    </div>
                    <span class="diagram-arrow">‚Üí</span>
                    <div class="diagram-box highlight-coral" style="min-width: 130px;">
                        <span class="box-label">Servidor</span>
                        <span class="box-desc">Esquece tudo!</span>
                    </div>
                    <span class="diagram-arrow">‚Üê</span>
                    <div class="diagram-box" style="min-width: 130px;">
                        <span class="box-label">Requisi√ß√£o 2</span>
                        <span class="box-desc">Quem √© voc√™?</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 5: Cookies -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Cookies ‚Äî O que s√£o?</h2></div>
            <div class="slide-body">
                <p><strong>Cookies</strong> s√£o pequenos arquivos de texto armazenados <strong>no navegador do usu√°rio</strong>. O servidor envia o cookie e o navegador o reenvia em cada requisi√ß√£o.</p>
                <div class="diagram-flow" style="margin-top: 15px; justify-content: center;">
                    <div class="diagram-box" style="min-width: 130px;">
                        <span class="box-label">Servidor</span>
                        <span class="box-desc">Set-Cookie: nome=Jo√£o</span>
                    </div>
                    <span class="diagram-arrow">‚Üí</span>
                    <div class="diagram-box highlight" style="min-width: 130px;">
                        <span class="box-label">Navegador</span>
                        <span class="box-desc">Armazena o cookie</span>
                    </div>
                    <span class="diagram-arrow">‚Üí</span>
                    <div class="diagram-box" style="min-width: 130px;">
                        <span class="box-label">Pr√≥xima requisi√ß√£o</span>
                        <span class="box-desc">Cookie: nome=Jo√£o</span>
                    </div>
                </div>
                <table style="margin-top: 15px;">
                    <thead><tr><th>Caracter√≠stica</th><th>Detalhe</th></tr></thead>
                    <tbody>
                        <tr><td>Armazenamento</td><td>No <strong>navegador</strong> do usu√°rio</td></tr>
                        <tr><td>Tamanho m√°ximo</td><td>~4 KB por cookie</td></tr>
                        <tr><td>Validade</td><td>Configur√°vel (minutos, dias, anos)</td></tr>
                        <tr><td>Seguran√ßa</td><td>Vis√≠vel ao usu√°rio ‚Äî <strong>n√£o armazene senhas!</strong></td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- SLIDE 6: Cookies no ASP.NET -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Cookies no ASP.NET Core</h2></div>
            <div class="slide-body">
                <pre>
<span class="comment">// GRAVAR um cookie</span>
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">GravarCookie</span>()
{
    <span class="keyword">var</span> <span class="js-var">opcoes</span> = <span class="keyword">new</span> <span class="type">CookieOptions</span>
    {
        Expires = DateTime.Now.<span class="js-func">AddDays</span>(<span class="number">7</span>),  <span class="comment">// Expira em 7 dias</span>
        HttpOnly = <span class="keyword">true</span>,                      <span class="comment">// N√£o acess√≠vel via JS</span>
        Secure = <span class="keyword">true</span>                          <span class="comment">// Apenas HTTPS</span>
    };
    Response.Cookies.<span class="js-func">Append</span>(<span class="js-string">"usuario"</span>, <span class="js-string">"Jo√£o"</span>, <span class="js-var">opcoes</span>);
    <span class="keyword">return</span> <span class="js-func">RedirectToAction</span>(<span class="js-string">"Index"</span>);
}

<span class="comment">// LER um cookie</span>
<span class="keyword">var</span> <span class="js-var">nome</span> = Request.Cookies[<span class="js-string">"usuario"</span>] ?? <span class="js-string">"Visitante"</span>;

<span class="comment">// EXCLUIR um cookie</span>
Response.Cookies.<span class="js-func">Delete</span>(<span class="js-string">"usuario"</span>);</pre>
            </div>
        </div>

        <!-- SLIDE 7: Mini Quiz (meio) -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Mini Quiz</h2></div>
            <div class="slide-body" style="justify-content: center;">
                <div class="quiz-container" data-answer="a">
                    <h3>Vamos verificar!</h3>
                    <p class="quiz-question">Onde os <strong>cookies</strong> s√£o armazenados?</p>
                    <ul class="quiz-options">
                        <li><button class="quiz-option" data-option="a">a) No navegador do usu√°rio</button></li>
                        <li><button class="quiz-option" data-option="b">b) No servidor web</button></li>
                        <li><button class="quiz-option" data-option="c">c) No banco de dados</button></li>
                        <li><button class="quiz-option" data-option="d">d) Na mem√≥ria RAM do servidor</button></li>
                    </ul>
                    <div class="quiz-feedback">A resposta correta √© <strong>(a)</strong>. Cookies s√£o armazenados no navegador do usu√°rio. Por isso, <strong>nunca armazene dados sens√≠veis</strong> como senhas em cookies!</div>
                </div>
            </div>
        </div>

        <!-- SLIDE 8: Sess√µes -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Sess√µes ‚Äî O que s√£o?</h2></div>
            <div class="slide-body">
                <p><strong>Sess√µes</strong> armazenam dados <strong>no servidor</strong>. O navegador recebe apenas um ID de sess√£o (via cookie) para identificar o usu√°rio.</p>
                <div class="diagram-flow" style="margin-top: 15px; justify-content: center;">
                    <div class="diagram-box" style="min-width: 140px;">
                        <span class="box-label">Navegador</span>
                        <span class="box-desc">Cookie: SessionId=abc123</span>
                    </div>
                    <span class="diagram-arrow">‚Üí</span>
                    <div class="diagram-box highlight" style="min-width: 200px;">
                        <span class="box-label">Servidor</span>
                        <span class="box-desc">abc123 ‚Üí {nome: "Jo√£o", carrinho: [...]}</span>
                    </div>
                </div>
                <table style="margin-top: 15px;">
                    <thead><tr><th>Cookies</th><th>Sess√µes</th></tr></thead>
                    <tbody>
                        <tr><td>Armazenados no <strong>navegador</strong></td><td>Armazenados no <strong>servidor</strong></td></tr>
                        <tr><td>Limite de ~4 KB</td><td>Sem limite pr√°tico</td></tr>
                        <tr><td>Persistem ap√≥s fechar o navegador</td><td>Expiram ao fechar o navegador</td></tr>
                        <tr><td>Vis√≠veis ao usu√°rio</td><td><strong>Mais seguros</strong> (dados no servidor)</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- SLIDE 9: Sess√µes no ASP.NET -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Sess√µes no ASP.NET Core</h2></div>
            <div class="slide-body">
                <pre>
<span class="comment">// Program.cs ‚Äî Habilitar sess√µes</span>
builder.Services.<span class="js-func">AddDistributedMemoryCache</span>();
builder.Services.<span class="js-func">AddSession</span>(<span class="js-var">options</span> =>
{
    <span class="js-var">options</span>.IdleTimeout = TimeSpan.<span class="js-func">FromMinutes</span>(<span class="number">30</span>);
    <span class="js-var">options</span>.Cookie.HttpOnly = <span class="keyword">true</span>;
});

app.<span class="js-func">UseSession</span>();  <span class="comment">// Antes de MapControllerRoute</span>

<span class="comment">// GRAVAR na sess√£o</span>
HttpContext.Session.<span class="js-func">SetString</span>(<span class="js-string">"usuario"</span>, <span class="js-string">"Jo√£o"</span>);
HttpContext.Session.<span class="js-func">SetInt32</span>(<span class="js-string">"idade"</span>, <span class="number">25</span>);

<span class="comment">// LER da sess√£o</span>
<span class="keyword">var</span> <span class="js-var">nome</span> = HttpContext.Session.<span class="js-func">GetString</span>(<span class="js-string">"usuario"</span>);
<span class="keyword">var</span> <span class="js-var">idade</span> = HttpContext.Session.<span class="js-func">GetInt32</span>(<span class="js-string">"idade"</span>);

<span class="comment">// LIMPAR a sess√£o</span>
HttpContext.Session.<span class="js-func">Clear</span>();</pre>
            </div>
        </div>

        <!-- SLIDE 10: Objetos na sess√£o -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Armazenando Objetos na Sess√£o</h2></div>
            <div class="slide-body">
                <p>A sess√£o s√≥ aceita <span class="inline-code">string</span> e <span class="inline-code">int</span>. Para objetos complexos, usamos <strong>JSON</strong>:</p>
                <pre>
<span class="keyword">using</span> System.Text.Json;

<span class="comment">// Extens√µes para facilitar</span>
<span class="keyword">public static class</span> <span class="type">SessionExtensions</span>
{
    <span class="keyword">public static void</span> <span class="js-func">SetObject</span>&lt;T&gt;(
        <span class="keyword">this</span> <span class="type">ISession</span> <span class="js-var">session</span>, <span class="keyword">string</span> <span class="js-var">key</span>, T <span class="js-var">value</span>)
    {
        <span class="js-var">session</span>.<span class="js-func">SetString</span>(<span class="js-var">key</span>, 
            JsonSerializer.<span class="js-func">Serialize</span>(<span class="js-var">value</span>));
    }

    <span class="keyword">public static</span> T? <span class="js-func">GetObject</span>&lt;T&gt;(
        <span class="keyword">this</span> <span class="type">ISession</span> <span class="js-var">session</span>, <span class="keyword">string</span> <span class="js-var">key</span>)
    {
        <span class="keyword">var</span> <span class="js-var">json</span> = <span class="js-var">session</span>.<span class="js-func">GetString</span>(<span class="js-var">key</span>);
        <span class="keyword">return</span> <span class="js-var">json</span> == <span class="keyword">null</span> ? <span class="keyword">default</span> 
            : JsonSerializer.<span class="js-func">Deserialize</span>&lt;T&gt;(<span class="js-var">json</span>);
    }
}</pre>
            </div>
        </div>

        <!-- SLIDE 11: Caso de Uso Real -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Caso de Uso Real</h2></div>
            <div class="slide-body">
                <div class="real-world">
                    <h3>Amazon ‚Äî Carrinho de Compras</h3>
                    <span class="company-tag">Amazon</span>
                    <span class="company-tag">Sess√µes</span>
                    <span class="company-tag">Cookies</span>
                    <p style="margin-top: 10px;">Quando voc√™ adiciona itens ao carrinho da Amazon, eles s√£o armazenados na <strong>sess√£o</strong>. Se voc√™ fechar o navegador e voltar, os itens ainda est√£o l√° ‚Äî porque a Amazon tamb√©m usa <strong>cookies</strong> para identificar voc√™ e restaurar a sess√£o.</p>
                </div>
                <div class="concept-cards" style="margin-top: 10px;">
                    <div class="concept-card">
                        <span class="card-icon">üç™</span>
                        <h4>Cookie</h4>
                        <p>"Lembra quem √© voc√™" ‚Äî identifica o usu√°rio entre visitas</p>
                    </div>
                    <div class="concept-card">
                        <span class="card-icon">üõí</span>
                        <h4>Sess√£o</h4>
                        <p>"Guarda o carrinho" ‚Äî armazena dados tempor√°rios no servidor</p>
                    </div>
                    <div class="concept-card">
                        <span class="card-icon">üíæ</span>
                        <h4>Banco de Dados</h4>
                        <p>"Salva para sempre" ‚Äî persiste pedidos finalizados</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 12: Exerc√≠cio Guiado -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Exerc√≠cio Guiado</h2></div>
            <div class="slide-body">
                <div class="guided-exercise">
                    <h3>Carrinho de Compras com Sess√£o</h3>
                    <div class="timebox">40 minutos</div>
                    <ol class="guided-steps">
                        <li>Configure sess√µes no <span class="inline-code">Program.cs</span> (AddSession + UseSession)</li>
                        <li>Crie as extens√µes <span class="inline-code">SetObject</span> e <span class="inline-code">GetObject</span></li>
                        <li>Na listagem de produtos, adicione um bot√£o "Adicionar ao Carrinho"</li>
                        <li>Crie a Action <span class="inline-code">AdicionarAoCarrinho(int id)</span> que salva o produto na sess√£o</li>
                        <li>Crie a Action <span class="inline-code">Carrinho()</span> que exibe os itens da sess√£o</li>
                        <li>Crie um bot√£o "Limpar Carrinho" que chama <span class="inline-code">Session.Clear()</span></li>
                        <li>Teste: adicione 3 produtos, veja o carrinho, limpe e verifique</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- SLIDE 13: Prepara√ß√£o -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Prepara√ß√£o para a Pr√≥xima Aula</h2></div>
            <div class="slide-body" style="justify-content: center;">
                <div class="box-preclass">
                    <h3>Atividade Pr√©-Aula (Obrigat√≥ria)</h3>
                    <p>Para a <strong>Aula 14 ‚Äî Requisi√ß√µes HTTP Ass√≠ncronas (AJAX)</strong>:</p>
                    <ol style="margin-top: 10px;">
                        <li>Revise o JavaScript <span class="inline-code">fetch()</span> da Aula 06</li>
                        <li>Pesquise o que √© <strong>AJAX</strong> e por que √© importante</li>
                        <li>Pesquise a diferen√ßa entre requisi√ß√£o <strong>s√≠ncrona</strong> e <strong>ass√≠ncrona</strong></li>
                        <li>Pense: por que o Instagram n√£o recarrega a p√°gina quando voc√™ curte uma foto?</li>
                    </ol>
                    <p style="margin-top: 15px;"><strong>Tempo estimado:</strong> 25 minutos</p>
                </div>
            </div>
        </div>

        <!-- SLIDE 14: Encerramento -->
        <div class="slide slide-cover">
            <h1>Obrigado!</h1>
            <h2>D√∫vidas?</h2>
            <p>jose.romualdo@uni9.pro.br</p>
            <p style="margin-top: 30px; font-size: 0.9em; color: rgba(255,255,255,0.5);">Aula 13 ‚Äî Cookies e Sess√µes</p>
        </div>

    </div>
    <script src="js/slides.js"></script>
</body>
</html>
