<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aula 12 - CRUD Completo com EF Core | Desenvolvimento Web - UNINOVE</title>
    <link rel="stylesheet" href="css/slides.css">
</head>
<body>
    <div class="presentation">

        <!-- SLIDE 1: Capa -->
        <div class="slide slide-cover active">
            <h1>Desenvolvimento Web</h1>
            <h2>Aula 12 ‚Äî CRUD Completo com EF Core</h2>
            <p>Create, Read, Update e Delete no banco de dados</p>
            <p style="margin-top: 30px; font-size: 0.9em; color: rgba(255,255,255,0.5);">2026.1 ‚Äî 120 minutos</p>
        </div>

        <!-- SLIDE 2: Recapitula√ß√£o -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Recapitula√ß√£o ‚Äî Aula 11</h2></div>
            <div class="slide-body">
                <div class="recap-container">
                    <h3>O que vimos na aula passada</h3>
                    <ul class="recap-items">
                        <li class="recap-item"><strong>ORM:</strong> Mapeia objetos C# para tabelas do banco ‚Äî sem SQL manual</li>
                        <li class="recap-item"><strong>EF Core:</strong> ORM oficial da Microsoft ‚Äî suporta MySQL via Pomelo</li>
                        <li class="recap-item"><strong>DbContext:</strong> Classe central que gerencia a conex√£o e os DbSets</li>
                        <li class="recap-item"><strong>Migrations:</strong> Cria e atualiza o banco automaticamente a partir do c√≥digo</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- SLIDE 3: Agenda -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Agenda</h2></div>
            <div class="slide-body">
                <ul class="agenda-list">
                    <li>O que √© CRUD?</li>
                    <li>Create ‚Äî Inserir registros</li>
                    <li>Read ‚Äî Listar e buscar registros</li>
                    <li>Update ‚Äî Atualizar registros</li>
                    <li>Delete ‚Äî Excluir registros</li>
                    <li>Caso de Uso Real: Mercado Livre</li>
                    <li>Exerc√≠cio Guiado: CRUD de Produtos</li>
                    <li>Mini Quiz</li>
                </ul>
            </div>
        </div>

        <!-- SLIDE 4: O que √© CRUD -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>O que √© CRUD?</h2></div>
            <div class="slide-body">
                <p><strong>CRUD</strong> s√£o as 4 opera√ß√µes b√°sicas de qualquer sistema que trabalha com dados:</p>
                <div class="concept-cards" style="margin-top: 15px;">
                    <div class="concept-card">
                        <span class="card-icon" style="font-size: 2em;">‚ûï</span>
                        <h4>Create</h4>
                        <p>Inserir novos registros</p>
                        <p style="font-size: 0.8em; color: #4ecdc4;">_context.Add()</p>
                    </div>
                    <div class="concept-card">
                        <span class="card-icon" style="font-size: 2em;">üìñ</span>
                        <h4>Read</h4>
                        <p>Listar e buscar registros</p>
                        <p style="font-size: 0.8em; color: #4ecdc4;">_context.ToList()</p>
                    </div>
                    <div class="concept-card">
                        <span class="card-icon" style="font-size: 2em;">‚úèÔ∏è</span>
                        <h4>Update</h4>
                        <p>Atualizar registros existentes</p>
                        <p style="font-size: 0.8em; color: #4ecdc4;">_context.Update()</p>
                    </div>
                    <div class="concept-card">
                        <span class="card-icon" style="font-size: 2em;">üóëÔ∏è</span>
                        <h4>Delete</h4>
                        <p>Excluir registros</p>
                        <p style="font-size: 0.8em; color: #4ecdc4;">_context.Remove()</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 5: Create -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Create ‚Äî Inserir Registros</h2></div>
            <div class="slide-body">
                <pre>
<span class="comment">// Controller ‚Äî Action POST para criar</span>
[<span class="type">HttpPost</span>]
[<span class="type">ValidateAntiForgeryToken</span>]
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">Criar</span>(<span class="type">Produto</span> <span class="js-var">produto</span>)
{
    <span class="keyword">if</span> (ModelState.IsValid)
    {
        _context.Produtos.<span class="js-func">Add</span>(<span class="js-var">produto</span>);   <span class="comment">// Adiciona ao contexto</span>
        _context.<span class="js-func">SaveChanges</span>();              <span class="comment">// Salva no banco (INSERT)</span>
        <span class="keyword">return</span> <span class="js-func">RedirectToAction</span>(<span class="js-string">"Index"</span>);
    }
    <span class="keyword">return</span> <span class="js-func">View</span>(<span class="js-var">produto</span>);
}</pre>
                <div class="box-info" style="margin-top: 10px;">
                    <p><span class="inline-code">Add()</span> marca o objeto para inser√ß√£o. <span class="inline-code">SaveChanges()</span> executa o INSERT no banco. Sempre chame SaveChanges()!</p>
                </div>
            </div>
        </div>

        <!-- SLIDE 6: Read -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Read ‚Äî Listar e Buscar</h2></div>
            <div class="slide-body">
                <pre>
<span class="comment">// Listar todos</span>
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">Index</span>()
{
    <span class="keyword">var</span> <span class="js-var">produtos</span> = _context.Produtos.<span class="js-func">ToList</span>();
    <span class="keyword">return</span> <span class="js-func">View</span>(<span class="js-var">produtos</span>);
}

<span class="comment">// Buscar por ID</span>
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">Detalhes</span>(<span class="keyword">int</span>? <span class="js-var">id</span>)
{
    <span class="keyword">if</span> (<span class="js-var">id</span> == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="js-func">NotFound</span>();
    <span class="keyword">var</span> <span class="js-var">produto</span> = _context.Produtos.<span class="js-func">Find</span>(<span class="js-var">id</span>);
    <span class="keyword">if</span> (<span class="js-var">produto</span> == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="js-func">NotFound</span>();
    <span class="keyword">return</span> <span class="js-func">View</span>(<span class="js-var">produto</span>);
}

<span class="comment">// Buscar com filtro (LINQ)</span>
<span class="keyword">var</span> <span class="js-var">baratos</span> = _context.Produtos
    .<span class="js-func">Where</span>(p => p.Preco < <span class="number">100</span>)
    .<span class="js-func">OrderBy</span>(p => p.Nome).<span class="js-func">ToList</span>();</pre>
            </div>
        </div>

        <!-- SLIDE 7: Update -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Update ‚Äî Atualizar Registros</h2></div>
            <div class="slide-body">
                <pre>
<span class="comment">// GET: Exibe o formul√°rio de edi√ß√£o preenchido</span>
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">Editar</span>(<span class="keyword">int</span>? <span class="js-var">id</span>)
{
    <span class="keyword">if</span> (<span class="js-var">id</span> == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="js-func">NotFound</span>();
    <span class="keyword">var</span> <span class="js-var">produto</span> = _context.Produtos.<span class="js-func">Find</span>(<span class="js-var">id</span>);
    <span class="keyword">if</span> (<span class="js-var">produto</span> == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="js-func">NotFound</span>();
    <span class="keyword">return</span> <span class="js-func">View</span>(<span class="js-var">produto</span>);
}

<span class="comment">// POST: Recebe os dados atualizados</span>
[<span class="type">HttpPost</span>]
[<span class="type">ValidateAntiForgeryToken</span>]
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">Editar</span>(<span class="keyword">int</span> <span class="js-var">id</span>, <span class="type">Produto</span> <span class="js-var">produto</span>)
{
    <span class="keyword">if</span> (<span class="js-var">id</span> != <span class="js-var">produto</span>.Id) <span class="keyword">return</span> <span class="js-func">NotFound</span>();
    <span class="keyword">if</span> (ModelState.IsValid)
    {
        _context.<span class="js-func">Update</span>(<span class="js-var">produto</span>);
        _context.<span class="js-func">SaveChanges</span>();
        <span class="keyword">return</span> <span class="js-func">RedirectToAction</span>(<span class="js-string">"Index"</span>);
    }
    <span class="keyword">return</span> <span class="js-func">View</span>(<span class="js-var">produto</span>);
}</pre>
            </div>
        </div>

        <!-- SLIDE 8: Delete -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Delete ‚Äî Excluir Registros</h2></div>
            <div class="slide-body">
                <pre>
<span class="comment">// GET: Exibe a confirma√ß√£o de exclus√£o</span>
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">Excluir</span>(<span class="keyword">int</span>? <span class="js-var">id</span>)
{
    <span class="keyword">if</span> (<span class="js-var">id</span> == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="js-func">NotFound</span>();
    <span class="keyword">var</span> <span class="js-var">produto</span> = _context.Produtos.<span class="js-func">Find</span>(<span class="js-var">id</span>);
    <span class="keyword">if</span> (<span class="js-var">produto</span> == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="js-func">NotFound</span>();
    <span class="keyword">return</span> <span class="js-func">View</span>(<span class="js-var">produto</span>);
}

<span class="comment">// POST: Confirma e exclui</span>
[<span class="type">HttpPost</span>, <span class="type">ActionName</span>(<span class="js-string">"Excluir"</span>)]
[<span class="type">ValidateAntiForgeryToken</span>]
<span class="keyword">public</span> <span class="type">IActionResult</span> <span class="js-func">ExcluirConfirmado</span>(<span class="keyword">int</span> <span class="js-var">id</span>)
{
    <span class="keyword">var</span> <span class="js-var">produto</span> = _context.Produtos.<span class="js-func">Find</span>(<span class="js-var">id</span>);
    <span class="keyword">if</span> (<span class="js-var">produto</span> != <span class="keyword">null</span>)
    {
        _context.Produtos.<span class="js-func">Remove</span>(<span class="js-var">produto</span>);
        _context.<span class="js-func">SaveChanges</span>();
    }
    <span class="keyword">return</span> <span class="js-func">RedirectToAction</span>(<span class="js-string">"Index"</span>);
}</pre>
            </div>
        </div>

        <!-- SLIDE 9: Fluxo visual -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Fluxo Completo do CRUD</h2></div>
            <div class="slide-body">
                <div class="diagram-flow" style="justify-content: center; margin-top: 10px;">
                    <div class="diagram-box" style="min-width: 120px;">
                        <span class="box-label">Index</span>
                        <span class="box-desc">Lista todos</span>
                    </div>
                    <span class="diagram-arrow">‚Üí</span>
                    <div class="diagram-box highlight" style="min-width: 120px;">
                        <span class="box-label">Criar</span>
                        <span class="box-desc">Formul√°rio novo</span>
                    </div>
                    <span class="diagram-arrow">‚Üí</span>
                    <div class="diagram-box highlight-coral" style="min-width: 120px;">
                        <span class="box-label">Editar</span>
                        <span class="box-desc">Formul√°rio edi√ß√£o</span>
                    </div>
                    <span class="diagram-arrow">‚Üí</span>
                    <div class="diagram-box" style="min-width: 120px;">
                        <span class="box-label">Excluir</span>
                        <span class="box-desc">Confirma√ß√£o</span>
                    </div>
                </div>
                <table style="margin-top: 20px;">
                    <thead><tr><th>Opera√ß√£o</th><th>HTTP</th><th>EF Core</th><th>SQL</th></tr></thead>
                    <tbody>
                        <tr><td>Create</td><td>POST</td><td><span class="inline-code">Add() + SaveChanges()</span></td><td>INSERT INTO</td></tr>
                        <tr><td>Read</td><td>GET</td><td><span class="inline-code">ToList() / Find()</span></td><td>SELECT</td></tr>
                        <tr><td>Update</td><td>POST</td><td><span class="inline-code">Update() + SaveChanges()</span></td><td>UPDATE SET</td></tr>
                        <tr><td>Delete</td><td>POST</td><td><span class="inline-code">Remove() + SaveChanges()</span></td><td>DELETE FROM</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- SLIDE 10: Caso de Uso Real -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Caso de Uso Real</h2></div>
            <div class="slide-body">
                <div class="real-world">
                    <h3>Mercado Livre ‚Äî Gerenciamento de An√∫ncios</h3>
                    <span class="company-tag">Mercado Livre</span>
                    <span class="company-tag">CRUD</span>
                    <span class="company-tag">E-commerce</span>
                    <p style="margin-top: 10px;">Quando um vendedor no Mercado Livre <strong>cria</strong> um an√∫ncio, <strong>lista</strong> seus produtos, <strong>edita</strong> o pre√ßo ou <strong>exclui</strong> um item, ele est√° executando opera√ß√µes CRUD. Toda aplica√ß√£o web com dados persistentes usa CRUD.</p>
                </div>
                <div class="concept-cards two-cols" style="margin-top: 10px;">
                    <div class="concept-card">
                        <h4>Vendedor</h4>
                        <p>Cria, edita e exclui an√∫ncios (CRUD completo)</p>
                    </div>
                    <div class="concept-card">
                        <h4>Comprador</h4>
                        <p>Lista e busca produtos (Read)</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- SLIDE 11: Exerc√≠cio Guiado -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Exerc√≠cio Guiado</h2></div>
            <div class="slide-body">
                <div class="guided-exercise">
                    <h3>CRUD Completo de Produtos</h3>
                    <div class="timebox">40 minutos</div>
                    <ol class="guided-steps">
                        <li>No <span class="inline-code">ProdutoController</span>, injete o <span class="inline-code">AppDbContext</span> via construtor</li>
                        <li>Crie a Action <span class="inline-code">Index()</span> que lista todos os produtos do banco</li>
                        <li>Crie a View <span class="inline-code">Index.cshtml</span> com tabela e links para Editar/Excluir</li>
                        <li>Crie as Actions <span class="inline-code">[HttpGet] Criar()</span> e <span class="inline-code">[HttpPost] Criar()</span></li>
                        <li>Crie as Actions <span class="inline-code">Editar(int id)</span> (GET e POST)</li>
                        <li>Crie as Actions <span class="inline-code">Excluir(int id)</span> (GET e POST)</li>
                        <li>Crie as Views correspondentes para cada opera√ß√£o</li>
                        <li>Teste todas as opera√ß√µes: criar, listar, editar e excluir</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- SLIDE 12: Mini Quiz -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Mini Quiz</h2></div>
            <div class="slide-body" style="justify-content: center;">
                <div class="quiz-container" data-answer="b">
                    <h3>Teste seus conhecimentos!</h3>
                    <p class="quiz-question">Qual m√©todo do EF Core √© obrigat√≥rio chamar <strong>ap√≥s</strong> Add(), Update() ou Remove() para persistir no banco?</p>
                    <ul class="quiz-options">
                        <li><button class="quiz-option" data-option="a">a) CommitChanges()</button></li>
                        <li><button class="quiz-option" data-option="b">b) SaveChanges()</button></li>
                        <li><button class="quiz-option" data-option="c">c) ExecuteQuery()</button></li>
                        <li><button class="quiz-option" data-option="d">d) PersistData()</button></li>
                    </ul>
                    <div class="quiz-feedback">A resposta correta √© <strong>(b)</strong>. <span class="inline-code">SaveChanges()</span> envia todas as altera√ß√µes pendentes para o banco de dados. Sem ele, nada √© persistido!</div>
                </div>
            </div>
        </div>

        <!-- SLIDE 13: Prepara√ß√£o -->
        <div class="slide slide-content">
            <div class="slide-header"><h2>Prepara√ß√£o para a Pr√≥xima Aula</h2></div>
            <div class="slide-body" style="justify-content: center;">
                <div class="box-preclass">
                    <h3>Atividade Pr√©-Aula (Obrigat√≥ria)</h3>
                    <p>Para a <strong>Aula 13 ‚Äî Cookies e Sess√µes</strong>:</p>
                    <ol style="margin-top: 10px;">
                        <li>Pesquise a diferen√ßa entre <strong>Cookies</strong> e <strong>Sess√µes</strong></li>
                        <li>Leia sobre o protocolo HTTP ser <strong>stateless</strong> (sem estado)</li>
                        <li>Pesquise como um carrinho de compras mant√©m os itens entre p√°ginas</li>
                        <li>Certifique-se de que o CRUD de produtos est√° funcionando</li>
                    </ol>
                    <p style="margin-top: 15px;"><strong>Tempo estimado:</strong> 25 minutos</p>
                </div>
            </div>
        </div>

        <!-- SLIDE 14: Encerramento -->
        <div class="slide slide-cover">
            <h1>Obrigado!</h1>
            <h2>D√∫vidas?</h2>
            <p>jose.romualdo@uni9.pro.br</p>
            <p style="margin-top: 30px; font-size: 0.9em; color: rgba(255,255,255,0.5);">Aula 12 ‚Äî CRUD Completo com EF Core</p>
        </div>

    </div>
    <script src="js/slides.js"></script>
</body>
</html>
